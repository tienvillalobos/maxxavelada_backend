{% extends "base.html" %}
{% block title %}Maxxa Velada - Leaderboard{% endblock %}
{% block content %}
<h1 class="page-title">Leaderboard</h1>

<form method="get" action="/" class="row g-2 mb-4">
  <div class="col-auto flex-grow-1">
    <label for="name" class="form-label visually-hidden">Buscar por nombre</label>
    <input type="text" class="form-control" id="name" name="name" value="{{ search_name or '' }}" placeholder="Buscar jugador por nombre...">
  </div>
  <div class="col-auto">
    <button type="submit" class="btn btn-blue">Buscar</button>
  </div>
  {% if search_name %}
  <div class="col-auto">
    <a href="/" class="btn btn-outline-secondary">Limpiar</a>
  </div>
  {% endif %}
</form>

<div class="card card-arcade">
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-arcade table-hover mb-0">
        <thead>
          <tr>
            <th>#</th>
            <th>Jugador</th>
            <th>Wins</th>
            <th>Losses</th>
            <th>Partidas</th>
            <th>Win rate</th>
          </tr>
        </thead>
        <tbody>
          {% for r in rows %}
          <tr>
            <td>
              {% if r.rank == 1 %}<span class="rank-gold">ðŸ¥‡ {{ r.rank }}</span>
              {% elif r.rank == 2 %}<span class="rank-silver">ðŸ¥ˆ {{ r.rank }}</span>
              {% elif r.rank == 3 %}<span class="rank-bronze">ðŸ¥‰ {{ r.rank }}</span>
              {% else %}{{ r.rank }}{% endif %}
            </td>
            <td><strong>{{ r.name }}</strong></td>
            <td class="text-success">{{ r.wins }}</td>
            <td class="text-danger">{{ r.losses }}</td>
            <td>{{ r.total_games }}</td>
            <td><span class="text-primary fw-bold">{{ r.win_rate_pct }}%</span></td>
          </tr>
          {% else %}
          <tr><td colspan="6" class="text-center text-muted py-4">No hay jugadores. {% if search_name %}Prueba otro nombre.{% else %}AÃºn no hay datos.{% endif %}</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

{% if pages > 1 %}
<nav class="mt-4" aria-label="PaginaciÃ³n del leaderboard">
  <ul class="pagination justify-content-center flex-wrap">
    <li class="page-item {% if not has_prev %}disabled{% endif %}">
      <a class="page-link" href="{% if has_prev %}/?page={{ page - 1 }}{% if search_name %}&name={{ search_name }}{% endif %}{% else %}#{% endif %}">Anterior</a>
    </li>
    <li class="page-item active"><span class="page-link">{{ page }} / {{ pages }}</span></li>
    <li class="page-item {% if not has_next %}disabled{% endif %}">
      <a class="page-link" href="{% if has_next %}/?page={{ page + 1 }}{% if search_name %}&name={{ search_name }}{% endif %}{% else %}#{% endif %}">Siguiente</a>
    </li>
  </ul>
</nav>
{% endif %}
{% if total > 0 %}
  <p class="text-center text-muted small mt-2">PÃ¡gina {{ page }} de {{ pages }} Â· {{ total }} jugador(es)</p>
{% endif %}
{% endblock %}
